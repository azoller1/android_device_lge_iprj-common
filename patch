diff --git a/BoardConfigCommon.mk b/BoardConfigCommon.mk
index e9535d7..a0abbbc 100644
--- a/BoardConfigCommon.mk
+++ b/BoardConfigCommon.mk
@@ -111,33 +111,24 @@ BOARD_SEPOLICY_DIRS += \
         device/lge/iprj-common/sepolicy
 
 BOARD_SEPOLICY_UNION += \
-        genfs_contexts \
-        file_contexts \
-	property_contexts \
-	te_macros \
+	genfs_contexts \
+	app.te \
 	bluetooth.te \
-	camera.te \
 	device.te \
-	dhcp.te \
 	domain.te \
 	drmserver.te \
 	file.te \
-	kickstart.te \
-	init.te \
+	file_contexts \
+	hci_init.te \
+	init_hell.te \
+	keystore.te \
 	mediaserver.te \
-	mpdecision.te \
-	netmgrd.te \
-	property.te \
-	qmux.te \
+	kickstart.te \
 	rild.te \
-	rmt.te \
-	sensors.te \
 	surfaceflinger.te \
 	system.te \
-	tee.te \
-	thermald.te \
 	ueventd.te \
-	wpa_supplicant.te
+	wpa.te
 
 BOARD_HARDWARE_CLASS := device/lge/iprj-common/cmhw/
 
diff --git a/sepolicy/app.te b/sepolicy/app.te
new file mode 100644
index 0000000..eb71391
--- /dev/null
+++ b/sepolicy/app.te
@@ -0,0 +1,3 @@
+# Grant GPU access to all processes started by Zygote.
+# They need that to render the standard UI.
+allow appdomain gpu_device:chr_file rw_file_perms;
diff --git a/sepolicy/camera.te b/sepolicy/camera.te
deleted file mode 100644
index e2fa4b5..0000000
--- a/sepolicy/camera.te
+++ /dev/null
@@ -1,26 +0,0 @@
-# Qualcomm MSM camera
-type camera, domain;
-type camera_exec, exec_type, file_type;
-
-# Started by init
-init_daemon_domain(camera)
-
-allow camera self:process execmem;
-
-allow camera camera_device:dir search;
-allow camera { video_device camera_device }:chr_file rw_file_perms;
-allow camera { surfaceflinger mediaserver }:fd use;
-
-# Create /data/cam_socket0 as camera_socket
-type_transition camera system_data_file:sock_file camera_socket "cam_socket0";
-allow camera camera_socket:sock_file { create unlink };
-allow camera system_data_file:dir remove_name;
-
-# All others under /data get camera_data_file
-file_type_auto_trans(camera, system_data_file, camera_data_file);
-allow camera camera_data_file:dir { write add_name };
-allow camera camera_data_file:file create_file_perms;
-
-# Connect to /data/app/sensor_ctl_socket
-unix_socket_connect(camera, sensors, sensors)
-allow camera sensors_socket:sock_file read;
diff --git a/sepolicy/device.te b/sepolicy/device.te
index e022fb8..5c87a9b 100644
--- a/sepolicy/device.te
+++ b/sepolicy/device.te
@@ -1,9 +1,20 @@
-type diagnostic_device, dev_type;
-type kgsl_device, dev_type, mlstrustedobject;
-type mpdecision_device, dev_type;
-type shared_log_device, dev_type;
-type power_control_device, dev_type;
-type efs_block_device, dev_type;
-type bluetooth_device, dev_type;
-type shared_memory_device, dev_type;
+# GPU (used by most UI apps)
+type gpu_device, dev_type;
+
+# Qualcomm Secure Execution Environment Communicator (QSEECOM) device
+type qseecom_device, dev_type;
+
+type diag_device, dev_type;
+type bcm2079x_device, dev_type;
+
+# Qualcomm MSM Audio ACDB device
+type msm_acdb_device, dev_type;
+
+# Kickstart device used by QC qcks
+type kickstart_device, dev_type;
+
+# SMD device, used by hci_qcomm_init
+type smd_device, dev_type;
+
+# RF kill device, used by wpa
 type rfkill_device, dev_type;
diff --git a/sepolicy/dhcp.te b/sepolicy/dhcp.te
deleted file mode 100644
index c403b9b..0000000
--- a/sepolicy/dhcp.te
+++ /dev/null
@@ -1 +0,0 @@
-allow dhcp self:rawip_socket { create write setopt };
diff --git a/sepolicy/domain.te b/sepolicy/domain.te
index 8fdcb15..45925a7 100644
--- a/sepolicy/domain.te
+++ b/sepolicy/domain.te
@@ -1,3 +1 @@
-allow domain kgsl_device:chr_file rw_file_perms;
-# libgsl is chatty about accessing /data/local/tmp
-dontaudit { surfaceflinger appdomain } shell_data_file:dir search;
+allow domain init_tmpfs:file read;
diff --git a/sepolicy/drmserver.te b/sepolicy/drmserver.te
index 2c224e1..0c8b461 100644
--- a/sepolicy/drmserver.te
+++ b/sepolicy/drmserver.te
@@ -1,2 +1,3 @@
-# Drm wants to read /firmware/image/tzapps.mdt
-r_dir_file(drmserver, radio_efs_file)
+# Grant DRM Service access to Qualcomm Secure Execution Environment Communicator (QSEECOM) device
+allow drmserver qseecom_device:chr_file rw_file_perms;
+allow drmserver sdcard_external:file open;
diff --git a/sepolicy/file.te b/sepolicy/file.te
index fe57c8e..839b0a4 100644
--- a/sepolicy/file.te
+++ b/sepolicy/file.te
@@ -1,21 +1,7 @@
-type mpdecision_socket, file_type;
-type qmuxd_socket, file_type;
-type sensors_socket, file_type;
-type camera_socket, file_type;
+# Qualcomm MSM Interface (QMI) socket types
+type qmux_audio_socket, file_type;
+type qmux_bluetooth_socket, file_type;
+type qmux_gps_socket, file_type;
+type qmux_radio_socket, file_type;
 
-type kickstart_data_file, file_type, data_file_type;
-type sensors_data_file, file_type, data_file_type;
-type camera_data_file, file_type, data_file_type;
-
-# Default type for anything under /firmware
-type radio_efs_file, fs_type;
-
-# oncrpc radio access nodes
-type oncrpc_device, dev_type, file_type;
-
-# Persist firmware types
-type persist_file, file_type;
-type persist_bluetooth_file, file_type;
-type persist_drm_file, file_type;
-type persist_sensors_file, file_type;
-type persist_wifi_file, file_type;
+type audio_firmware_file, file_type;
diff --git a/sepolicy/file_contexts b/sepolicy/file_contexts
index 354cbaf..ccbb9b6 100644
--- a/sepolicy/file_contexts
+++ b/sepolicy/file_contexts
@@ -1,84 +1,36 @@
-/dev/msm_acdb                  u:object_r:audio_device:s0
-/dev/msm_mp3                   u:object_r:audio_device:s0
-/dev/msm_rtac                  u:object_r:audio_device:s0
-/dev/msm_vidc.*                u:object_r:audio_device:s0
-/dev/msm_amrnb.*               u:object_r:audio_device:s0
-/dev/msm_amrwb.*               u:object_r:audio_device:s0
-/dev/msm_aac.*                 u:object_r:audio_device:s0
-/dev/msm_pcm_out               u:object_r:audio_device:s0
-/dev/pmem_audio                u:object_r:audio_device:s0
+# GPU device
+/dev/kgsl-3d0       u:object_r:gpu_device:s0
+/dev/msm_rotator    u:object_r:gpu_device:s0
 
-# Jpeg Engine support
-/dev/gemini.*                  u:object_r:camera_device:s0
-# MSM camera related
-/dev/msm_camera.*              u:object_r:camera_device:s0
+# Qualcomm Secure Execution Environment Communicator (QSEECOM) device
+/dev/qseecom        u:object_r:qseecom_device:s0
 
-# Image Rotator Driver
-/dev/msm_rotator               u:object_r:video_device:s0
+# Qualcomm MSM Interface (QMI) devices
+/dev/socket/qmux_audio/*           u:object_r:qmux_audio_socket:s0
+/dev/socket/qmux_bluetooth/*       u:object_r:qmux_bluetooth_socket:s0
+/dev/socket/qmux_gps/*             u:object_r:qmux_gps_socket:s0
+/dev/socket/qmux_radio/*           u:object_r:qmux_radio_socket:s0
 
-# Sensors driver
-/dev/k3dh_acc_misc             u:object_r:sensors_device:s0
-/dev/k3g_misc                  u:object_r:sensors_device:s0
-/dev/ami306hal                 u:object_r:sensors_device:s0
+/dev/bcm2079x-i2c                  u:object_r:bcm2079x_device:s0
+/dev/diag                          u:object_r:diag_device:s0
+/dev/media([0-9])+                 u:object_r:camera_device:s0
+/dev/smd([0-9])+                   u:object_r:smd_device:s0
+/dev/mdm                           u:object_r:radio_device:s0
 
-/dev/mdm                       u:object_r:radio_device:s0
-/dev/rmnet_mux_ctrl            u:object_r:radio_device:s0
-/dev/smd7                      u:object_r:radio_device:s0
-/dev/smdcntl0                  u:object_r:radio_device:s0
-/dev/smdcntl1                  u:object_r:radio_device:s0
-/dev/smdcntl2                  u:object_r:radio_device:s0
-/dev/smdcntl3                  u:object_r:radio_device:s0
-/dev/smdcntl4                  u:object_r:radio_device:s0
-/dev/smdcntl5                  u:object_r:radio_device:s0
-/dev/smdcntl6                  u:object_r:radio_device:s0
-/dev/smdcntl7                  u:object_r:radio_device:s0
-/dev/sdioctl.*                 u:object_r:radio_device:s0
+# Qualcomm MSM Audio ACDB device
+/dev/msm_acdb       u:object_r:msm_acdb_device:s0
 
-/dev/ttyHS0                    u:object_r:hci_attach_dev:s0
-/dev/smd2                      u:object_r:hci_attach_dev:s0
-/dev/smd3                      u:object_r:hci_attach_dev:s0
+# Qualcomm audio firmware files
+/data/misc/audio/*                 u:object_r:audio_firmware_file:s0
 
-/dev/cpu_dma_latency           u:object_r:power_control_device:s0
-/dev/diag                      u:object_r:diagnostic_device:s0
-/dev/smd.*                     u:object_r:shared_memory_device:s0
-/dev/smem_log                  u:object_r:shared_log_device:s0
-/dev/kgsl-2d0                  u:object_r:kgsl_device:s0
-/dev/kgsl-2d1                  u:object_r:kgsl_device:s0
-/dev/kgsl-3d0                  u:object_r:kgsl_device:s0
+/dev/ks_hsic_bridge                u:object_r:kickstart_device:s0
+/dev/efs_hsic_bridge               u:object_r:kickstart_device:s0
 
-/dev/socket/mpctl              u:object_r:mpdecision_socket:s0
+/system/bin/qcks                   u:object_r:kickstart_exec:s0
+/system/bin/efsks                  u:object_r:kickstart_exec:s0
+/system/bin/ks                     u:object_r:kickstart_exec:s0
 
-# Block labeling
-/dev/block/mmcblk0p1[567]        u:object_r:efs_block_device:s0
+/data/nfc(/.*)?                    u:object_r:nfc_data_file:s0
 
-# Modem firmware loader
-/dev/ttyHSL1                       u:object_r:kickstart_device:s0
-/dev/tty_sdio_00                   u:object_r:kickstart_device:s0
-
-/dev/rfkill                      u:object_r:rfkill_device:s0
-
-/dev/rmt_storage                 u:object_r:rmt_device:s0
-
-# Data labeling
-/data/qcks(/.*)?               u:object_r:kickstart_data_file:s0
-/data/misc/sensors(/.*)?       u:object_r:sensors_data_file:s0
-/data/radio(/.*)?              u:object_r:qmuxd_socket:s0
-
-# System binaries
-/system/bin/rmt_storage          u:object_r:rmt_exec:s0
-/system/bin/thermald             u:object_r:thermald_exec:s0
-/system/bin/mpdecision           u:object_r:mpdecision_exec:s0
-/system/bin/qmuxd                u:object_r:qmux_exec:s0
-/system/bin/netmgrd              u:object_r:netmgrd_exec:s0
-/system/bin/ks                   u:object_r:kickstart_exec:s0
-/system/bin/qcks                 u:object_r:kickstart_exec:s0
-/system/etc/init.qcom.post_boot.sh      u:object_r:mpdecision_exec:s0
-
-# Persist firmware filesystem
-/persist(/.*)?                   u:object_r:persist_file:s0
-
-/dev/oncrpc(/.*)?                u:object_r:oncrpc_device:s0
-
-# Hardware tunables
-/sys/class/timed_output/vibrator/amp        u:object_r:sysfs_writable:s0
-/sys/devices/platform/mdp.524801/kcal       u:object_r:sysfs_writable:s0
+/system/bin/hci_qcomm_init         u:object_r:hci_exec:s0
+/system/bin/bdAddrLoader           u:object_r:hci_exec:s0
diff --git a/sepolicy/hci_init.te b/sepolicy/hci_init.te
new file mode 100644
index 0000000..85f5d32
--- /dev/null
+++ b/sepolicy/hci_init.te
@@ -0,0 +1,6 @@
+type hci_init, domain;
+permissive hci_init;
+type hci_exec, file_type, exec_type;
+type hci_data_file, file_type;
+domain_auto_trans(shell, hci_exec, hci_init)
+unconfined_domain(hci_init)
diff --git a/sepolicy/init.te b/sepolicy/init.te
deleted file mode 100644
index 3f11893..0000000
--- a/sepolicy/init.te
+++ /dev/null
@@ -1 +0,0 @@
-allow init wpa_socket:unix_dgram_socket { bind create };
diff --git a/sepolicy/init_shell.te b/sepolicy/init_shell.te
new file mode 100644
index 0000000..204392f
--- /dev/null
+++ b/sepolicy/init_shell.te
@@ -0,0 +1,6 @@
+allow init_shell diag_device:chr_file { read write };
+allow init_shell hci_exec:file rx_file_perms;
+allow init_shell bluetooth_prop:property_service set;
+allow init_shell smd_device:chr_file rw_file_perms;
+allow init_shell unlabeled:file r_file_perms;
+allow init_shell init:fifo_file r_file_perms;
diff --git a/sepolicy/keystore.te b/sepolicy/keystore.te
new file mode 100644
index 0000000..2583cac
--- /dev/null
+++ b/sepolicy/keystore.te
@@ -0,0 +1,3 @@
+# Grant keystore daemon access to Qualcomm Secure Execution Environment Communicator (QSEECOM) device
+allow keystore qseecom_device:chr_file rw_file_perms;
+
diff --git a/sepolicy/kickstart.te b/sepolicy/kickstart.te
index 449ec9b..f4a4a26 100644
--- a/sepolicy/kickstart.te
+++ b/sepolicy/kickstart.te
@@ -1,49 +1,5 @@
-# kickstart processes and scripts
 type kickstart, domain;
-type kickstart_exec, exec_type, file_type;
-type kickstart_device, dev_type;
-
-# kickstart_checker.sh talks to init over the property socket
-unix_socket_connect(kickstart, property, init)
-
-# Start /system/bin/qcks from init
-init_daemon_domain(kickstart)
-
-# Spawn /system/bin/efsks and /system/bin/ks
-allow kickstart kickstart_exec:file { open execute_no_trans getattr };
-
-# Run dd on m9kefs[123] block devices; write to /data/qcks/
-# Run cat on firmware and m9kefs[123] data; write to /data/qcks/
-allow kickstart efs_block_device:blk_file rw_file_perms;
-allow kickstart kickstart_data_file:file create_file_perms;
-allow kickstart kickstart_data_file:dir rw_dir_perms;
-allow kickstart radio_efs_file:file r_file_perms;
-allow kickstart radio_efs_file:dir search;
-
-# Let qcks access /dev/mdm node (modem driver)
-allow kickstart radio_device:chr_file r_file_perms;
-
-# Allow /dev/ttyUSB0 access
-allow kickstart radio_device:chr_file { write };
-
-# Allow to run toolbox commands
-allow kickstart shell_exec:file rx_file_perms;
-# Toolbox commands for firmware dd
-allow kickstart system_file:file execute_no_trans;
-
-# Access to /dev/block/platform/msm_sdcc.1/by-name/m9kefs2
-allow kickstart block_device:dir { getattr write search };
-
-# Set system property key
-allow kickstart radio_prop:property_service set;
-
-allow kickstart shell_exec:file entrypoint;
-# ls on /data/qcks/
-allow kickstart self:capability { dac_override fsetid fowner chown };
-
-# Access to the modem bridge chardevs
-allow kickstart kickstart_device:chr_file rw_file_perms;
-
-# set wake locks
-allow kickstart sysfs:file { append };
-
+permissive kickstart;
+type kickstart_exec, file_type, exec_type;
+domain_auto_trans(init, kickstart_exec, kickstart)
+unconfined_domain(kickstart)
diff --git a/sepolicy/mediaserver.te b/sepolicy/mediaserver.te
index b33b453..dacaacf 100644
--- a/sepolicy/mediaserver.te
+++ b/sepolicy/mediaserver.te
@@ -1,14 +1,13 @@
-allow mediaserver audio_data_file:dir w_dir_perms;
-allow mediaserver audio_data_file:file create_file_perms;
-allow mediaserver camera_data_file:sock_file w_file_perms;
+# Grant access to Qualcomm MSM Audio ACDB device to mediaserver
+allow mediaserver msm_acdb_device:chr_file rw_file_perms;
 
-qmux_socket(mediaserver)
-
-unix_socket_send(mediaserver, camera, camera)
+# Grant access to Qualcomm MSM Interface (QMI) audio sockets to mediaserver
+allow mediaserver qmux_audio_socket:sock_file create_file_perms;
+allow mediaserver qmux_audio_socket:dir rw_dir_perms;
 
+# Permit mediaserver to create sockets
 allow mediaserver self:socket create;
 
-# Allow logging diagnostic items
-allow mediaserver diagnostic_device:chr_file rw_file_perms;
-
-allow mediaserver oncrpc_device:chr_file rw_file_perms;
+# Grant access to audio firmware files to mediaserver
+allow mediaserver audio_firmware_file:dir ra_dir_perms;
+allow mediaserver audio_firmware_file:file create_file_perms;
diff --git a/sepolicy/mpdecision.te b/sepolicy/mpdecision.te
deleted file mode 100644
index 5c4d3f2..0000000
--- a/sepolicy/mpdecision.te
+++ /dev/null
@@ -1,16 +0,0 @@
-# CPU governor (root process)
-type mpdecision, domain;
-type mpdecision_exec, exec_type, file_type;
-
-# Started by init
-init_daemon_domain(mpdecision)
-
-# dac_override to unlink /dev/socket/mpdecision/touchboost
-allow mpdecision self:capability { dac_override fsetid net_admin };
-allow mpdecision self:netlink_kobject_uevent_socket { create read setopt bind read };
-
-allow mpdecision mpdecision_socket:dir w_dir_perms;
-allow mpdecision mpdecision_socket:sock_file { create setattr write };
-
-# XXX Should we label with own type?
-allow mpdecision sysfs:file { read open write getattr };
diff --git a/sepolicy/netmgrd.te b/sepolicy/netmgrd.te
deleted file mode 100644
index eeb5395..0000000
--- a/sepolicy/netmgrd.te
+++ /dev/null
@@ -1,28 +0,0 @@
-# Network utilities (radio process)
-type netmgrd, domain;
-type netmgrd_exec, exec_type, file_type;
-
-# Started by init
-init_daemon_domain(netmgrd)
-
-allow netmgrd self:udp_socket { create ioctl };
-# fsetid, dac_override unlink on /dev/socket/qmux_radio/qmux_client_socket
-allow netmgrd self:capability { sys_module fsetid setuid setgid net_admin net_raw dac_override };
-allow netmgrd self:packet_socket { write bind read create };
-allow netmgrd self:netlink_socket { write read create bind setopt };
-allow netmgrd self:netlink_route_socket { create bind read write nlmsg_read nlmsg_write setopt getattr };
-
-# Talk to qmuxd
-qmux_socket(netmgrd)
-
-# Allow logging diagnostic items
-allow netmgrd diagnostic_device:chr_file rw_file_perms;
-
-# /data/data_test/ access with shell
-allow netmgrd shell_exec:file { execute read open execute_no_trans };
-allow netmgrd system_file:file { execute_no_trans };
-
-# Talk to init over the property socket
-unix_socket_connect(netmgrd, property, init)
-# Set net.rmnet_usb0. values
-allow netmgrd radio_prop:property_service set;
diff --git a/sepolicy/property.te b/sepolicy/property.te
deleted file mode 100644
index 74e15e1..0000000
--- a/sepolicy/property.te
+++ /dev/null
@@ -1 +0,0 @@
-type bluetooth_prop, property_type;
diff --git a/sepolicy/property_contexts b/sepolicy/property_contexts
deleted file mode 100644
index d47798d..0000000
--- a/sepolicy/property_contexts
+++ /dev/null
@@ -1,3 +0,0 @@
-persist.service.bdroid.         u:object_r:bluetooth_prop:s0
-bluetooth.                      u:object_r:bluetooth_prop:s0
-net.rmnet_usb0.                 u:object_r:radio_prop:s0
diff --git a/sepolicy/qmux.te b/sepolicy/qmux.te
deleted file mode 100644
index 0f99606..0000000
--- a/sepolicy/qmux.te
+++ /dev/null
@@ -1,22 +0,0 @@
-# Qualcomm Management Interface Multiplexer
-type qmux, domain;
-type qmux_exec, exec_type, file_type;
-
-# Started by init
-init_daemon_domain(qmux)
-
-# Create local qmux_connect_socket
-allow qmux qmuxd_socket:dir w_dir_perms;
-allow qmux qmuxd_socket:sock_file { create setattr getattr unlink write };
-allow qmux init:unix_stream_socket connectto;
-
-# /dev/sdioctl* node access
-allow qmux radio_device:chr_file rw_file_perms;
-
-# Allow logging diagnostic items
-allow qmux diagnostic_device:chr_file rw_file_perms;
-
-# XXX Should we label with own type
-allow qmux sysfs:file { open write append read getattr };
-
-allow qmux shell_exec:file rx_file_perms;
diff --git a/sepolicy/rild.te b/sepolicy/rild.te
index ab3c55a..8ed6697 100644
--- a/sepolicy/rild.te
+++ b/sepolicy/rild.te
@@ -1,13 +1,7 @@
-allow rild self:netlink_socket { create bind read write };
-allow rild self:netlink_route_socket { write };
+allow rild diag_device:chr_file rw_file_perms;
 
-# Talk to qmuxd
-qmux_socket(rild)
+# Grant access to Qualcomm MSM Interface (QMI) radio sockets to RILD
+allow rild qmux_radio_socket:sock_file create_file_perms;
+allow rild qmux_radio_socket:dir rw_dir_perms;
 
-# Allow logging diagnostic items
-allow rild diagnostic_device:chr_file rw_file_perms;
-
-# XXX label with own type?
-allow rild sysfs:file { read open write getattr };
-
-allow rild oncrpc_device:chr_file rw_file_perms;
+#XXX allow rild oncrpc_device:chr_file rw_file_perms;
diff --git a/sepolicy/rmt.te b/sepolicy/rmt.te
deleted file mode 100644
index 82c63b0..0000000
--- a/sepolicy/rmt.te
+++ /dev/null
@@ -1,31 +0,0 @@
-# remote storage process
-type rmt, domain;
-type rmt_exec, exec_type, file_type;
-type rmt_device, dev_type, file_type;
-
-# Started by init
-init_daemon_domain(rmt)
-
-# opens and reads the primary block device
-allow rmt block_device:blk_file { open read write };
-allow rmt block_device:dir search;
-
-# XXX should we allow sys_rawio on /dev/mem?
-allow rmt self:capability { sys_rawio };
-# dac_override on open /sys/power/wake_lock
-allow rmt self:capability { setuid setgid dac_override };
-allow rmt self:socket { create ioctl bind setopt read };
-
-allow rmt cgroup:dir { create add_name };
-# XXX do we need write access?
-allow rmt kmem_device:chr_file rw_file_perms;
-allow rmt rmt_device:chr_file rw_file_perms;
-
-# Allow shared memory logging access
-allow rmt shared_log_device:chr_file rw_file_perms;
-
-# XXX Should we label with own type?
-allow rmt sysfs:file { open append read getattr write };
-allow rmt sysfs:dir rw_dir_perms;
-
-allow rmt efs_block_device:blk_file rw_file_perms;
diff --git a/sepolicy/sensors.te b/sepolicy/sensors.te
deleted file mode 100644
index 430fad4..0000000
--- a/sepolicy/sensors.te
+++ /dev/null
@@ -1,33 +0,0 @@
-# Integrated qualcomm sensor process
-type sensors, domain;
-type sensors_exec, exec_type, file_type;
-
-# Started by init
-init_daemon_domain(sensors)
-
-# dac_override open /dev/msm_dsps
-allow sensors self:capability { setuid setgid chown dac_override };
-
-# Allow logging diagnostic items
-allow sensors diagnostic_device:chr_file rw_file_perms;
-
-# Create /data/app/sensor_ctl_socket
-file_type_auto_trans(sensors, apk_data_file, sensors_socket);
-
-allow sensors sensors_data_file:dir create_dir_perms;
-allow sensors sensors_data_file:file create_file_perms;
-dontaudit sensors apk_data_file:dir remove_name;
-
-# Access to sensor nodes
-allow sensors sensors_device:chr_file rw_file_perms;
-
-# XXX should power_control_device be labeled differently?
-allow sensors power_control_device:chr_file { write open append };
-
-# Access to /persist/sensors
-allow sensors persist_file:dir { search getattr };
-allow sensors persist_sensors_file:dir r_dir_perms;
-allow sensors persist_sensors_file:file rw_file_perms;
-
-# XXX label with own type?
-allow sensors sysfs:file { open append read write getattr };
diff --git a/sepolicy/surfaceflinger.te b/sepolicy/surfaceflinger.te
index aca5928..787432d 100644
--- a/sepolicy/surfaceflinger.te
+++ b/sepolicy/surfaceflinger.te
@@ -1 +1,9 @@
+# Grant GPU access to SurfaceFlinger
+allow surfaceflinger gpu_device:chr_file rw_file_perms;
+
 allow surfaceflinger sysfs:file rw_file_perms;
+
+# Read from /data/local/tmp
+allow surfaceflinger shell_data_file:dir search;
+allow surfaceflinger shell_data_file:file { open getattr read };
+allow surfaceflinger shell_data_file:lnk_file read;
diff --git a/sepolicy/system.te b/sepolicy/system.te
index fb993c2..1965f7e 100644
--- a/sepolicy/system.te
+++ b/sepolicy/system.te
@@ -1,23 +1,11 @@
-allow system diagnostic_device:chr_file rw_file_perms;
+# Grant GPU access to system apps (e.g., PowerManagerService)
+allow system gpu_device:chr_file rw_file_perms;
+allow system diag_device:chr_file rw_file_perms;
 
-allow system init:unix_dgram_socket sendto;
-allow system wpa_socket:unix_dgram_socket sendto;
-
-qmux_socket(system)
-
-# PowerManagerService
-unix_socket_connect(system, sensors, sensors)
-allow system sensors_socket:sock_file read;
-allow system sensors:unix_stream_socket sendto;
-
-# mpdecision access
-unix_socket_connect(system, mpdecision, mpdecision)
-unix_socket_send(system, mpdecision, mpdecision)
-allow system mpdecision:unix_stream_socket sendto;
-allow system mpdecision_socket:dir search;
-
-allow system sysfs:file { read open write };
-
-allow system oncrpc_device:dir r_dir_perms;
-allow system oncrpc_device:chr_file rw_file_perms;
+# Grant access to Qualcomm MSM Interface (QMI) radio sockets to system apps
+# (e.g., LocationManager)
+allow system qmux_radio_socket:sock_file create_file_perms;
+allow system qmux_radio_socket:dir rw_dir_perms;
 
+#XXX allow system oncrpc_device:dir r_dir_perms;
+#XXX allow system oncrpc_device:chr_file rw_file_perms;
diff --git a/sepolicy/te_macros b/sepolicy/te_macros
deleted file mode 100644
index 274fd55..0000000
--- a/sepolicy/te_macros
+++ /dev/null
@@ -1,12 +0,0 @@
-#####################################
-# qmux_socket(clientdomain)
-# Allow client to send via a local
-# socket to the qmux domain.
-define(`qmux_socket', `
-type $1_qmuxd_socket, file_type;
-file_type_auto_trans($1, qmuxd_socket, $1_qmuxd_socket)
-unix_socket_connect($1, qmuxd, qmux)
-allow qmux $1_qmuxd_socket:sock_file { getattr unlink };
-')
-
-
diff --git a/sepolicy/tee.te b/sepolicy/tee.te
deleted file mode 100644
index 745de3c..0000000
--- a/sepolicy/tee.te
+++ /dev/null
@@ -1,12 +0,0 @@
-# Qualcomm Secure Execution Environment Communicator policy
-allow tee self:process execmem;
-
-# Access /data/misc/playready
-allow tee system_data_file:dir { open read };
-allow tee drm_data_file:dir rw_dir_perms;
-allow tee drm_data_file:file rw_file_perms;
-
-# Access /persist/{widevine,playready}
-allow tee persist_file:dir search;
-allow tee persist_drm_file:dir r_dir_perms;
-allow tee persist_drm_file:file r_file_perms;
diff --git a/sepolicy/thermald.te b/sepolicy/thermald.te
deleted file mode 100644
index bcc1e59..0000000
--- a/sepolicy/thermald.te
+++ /dev/null
@@ -1,22 +0,0 @@
-# Temperature sensor daemon (root process)
-type thermald, domain;
-type thermald_exec, exec_type, file_type;
-
-# Started by init
-init_daemon_domain(thermald)
-
-# XXX should we allow kexec_load with /dev/socket/qmux_radio/qmux_client_socket
-# dac_override open, unlink with /dev/socket/qmux_radio/qmux_client_socket
-allow thermald self:capability { net_admin fsetid dac_override };
-
-allow thermald self:socket { ioctl create write read };
-allow thermald self:netlink_kobject_uevent_socket { read create setopt bind };
-
-# Talk to qmuxd
-qmux_socket(thermald)
-
-# Access to shared memory logger and logging diagnostic items
-allow thermald { shared_log_device diagnostic_device oncrpc_device }:chr_file rw_file_perms;
-
-# XXX Should we label with own type?
-allow thermald sysfs:file { open read write getattr };
diff --git a/sepolicy/ueventd.te b/sepolicy/ueventd.te
index 3b4d5f7..88f5db2 100644
--- a/sepolicy/ueventd.te
+++ b/sepolicy/ueventd.te
@@ -1,7 +1,8 @@
-# Drivers read firmware files (/firmware/image, /vendor/firmware/wlan/prima)
-allow ueventd { radio_efs_file wifi_data_file }:file r_file_perms;
-allow ueventd { radio_efs_file wifi_data_file }:dir search;
+allow ueventd sdcard_external:dir search;
+allow ueventd sdcard_external:file r_file_perms;
+allow ueventd wifi_data_file:dir search;
+allow ueventd wifi_data_file:file r_file_perms;
 
-allow ueventd rmt_device:chr_file rw_file_perms;
-allow ueventd oncrpc_device:chr_file create_file_perms;
-allow ueventd oncrpc_device:dir create_dir_perms;
+#XXX allow ueventd rmt_device:chr_file rw_file_perms;
+#XXX allow ueventd oncrpc_device:chr_file create_file_perms;
+#XXX allow ueventd oncrpc_device:dir create_dir_perms;
diff --git a/sepolicy/wpa.te b/sepolicy/wpa.te
new file mode 100644
index 0000000..c8f185f
--- /dev/null
+++ b/sepolicy/wpa.te
@@ -0,0 +1 @@
+allow wpa devpts:chr_file rw_file_perms;
diff --git a/sepolicy/wpa_supplicant.te b/sepolicy/wpa_supplicant.te
deleted file mode 100644
index 9b9201a..0000000
--- a/sepolicy/wpa_supplicant.te
+++ /dev/null
@@ -1,8 +0,0 @@
-allow wpa init:unix_dgram_socket { read write };
-
-# logwrapper used with wpa_supplicant
-allow wpa devpts:chr_file { read write };
-
-allow wpa wpa_socket:unix_dgram_socket { read write };
-allow wpa_socket system:unix_dgram_socket sendto;
-allow wpa rfkill_device:chr_file rw_file_perms;
-- 
